# 개요
확장성 패턴은 10억 이상의 요청을 처리할 수 있도록 한다. 또한, 페타 바이트에 달하는 대용량 데이터 처리도 가능하다.

# 문제 상황
하나의 WAS에 여러 사용자가 요청을 보낼 경우, 큰 볼륨의 요청을 처리하지 못하게 된다. 스케일 업을 통해 당장의 요청을 견딜 수 있을지 몰라도 한계가 존재한다.

# 해결 방안

Source, Load Balancing Dispatcher, Workers

## 1. Cloud Load Balancing Service

### MSA에서 장점
![msa](img/msa.png)
요청이 많은 도메인에 대해서만 스케일 아웃을 진행하면 되기 때문에, 트래픽이 적은 도메인에 대해서 요금을 절약할 수 있음

### 로드밸런서도 요청이 몰리면 병목 생기는거 아님?
로드 밸런서 서비스를 여러 인스턴스로 스케일 아웃하여 돌리면 된다.
만약 한 LB 인스턴스가 장애가 발생해도 SPoF가 발생하지 않는다.

## 2. Message Broker
![message-broker](img/message-broker.png)
메시지 브로커는 로드 밸런싱을 위해서 사용하는 것이 아니다.
옳바른 사용 사례를 바탕으로 도입해야 한다.

# 라우팅 알고리즘
## 라운도 로빈
디폴트 알고리즘으로 많이 채택됨.
stateless 애플리케이션에서 잘 작동한다.
즉, 각 요청이 stacky session일 필요 없을 때 유용함

## Sticky Session
라운드 로빈으로 처리가 불가능할 경우 사용할 수 있는 알고리즘.
Sticky Session의 고질적인 문제인 특정 서버에 몰리는 문제가 있을 수 있다.
하나의 서버에 붙은 세션이 많으면 많은 요청이 해당 서버로 가기 때문이다.

## Least Connections
로드 밸런서가 가장 요청이 적은 Server로 보내는 방식.
장시간 연결을 요구하는 테스트에서 유리

# 장점
로드 밸런서에서만 메트릭을 수집할 수 있기 때문에 서버에는 순수 클라이언트 요청만 갈 수 있다.
이렇게 수집된 트래픽을 통해 스케일 아웃을 자동으로 할 수 잇다.
